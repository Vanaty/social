<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Registration</title>
</head>
<body>
<h1>Register</h1>
<form id="registrationForm">
	username: <input type="text" id="username" name="username"><br><br>
	password: <input type="password" id="password" value="test@user" name="password"><br><br>
	<input type="submit" value="Register">
</form>
<p id="message"></p>

<script>
document.getElementById('registrationForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const messageP = document.getElementById('message');
    messageP.textContent = '';

    fetch('/api/auth/register', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ username, password })
    })
    .then(response => {
        if (!response.ok) {
            return response.text().then(text => { throw new Error(text) });
        }
        return response.text();
    })
    .then(data => {
        messageP.style.color = 'green';
        messageP.textContent = 'Registration successful! Redirecting to login...';
        setTimeout(() => {
            window.location.href = '/index.html';
        }, 2000);
    })
    .catch(error => {
        console.error('Error:', error);
        messageP.style.color = 'red';
        messageP.textContent = 'Registration failed: ' + error.message;
    });
});
</script>
</body>
</html>